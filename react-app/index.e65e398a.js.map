{"mappings":"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","sources":["apps/examples/pages/react-app/react-app.tsx","packages/sketch-loop/lib/index.mjs","packages/sketch-react-app/lib/index.mjs"],"sourcesContent":["import * as React from 'react'\nimport {useState} from 'react'\nimport type {Application} from 'sketch-react-app'\n\nimport {createRoot} from 'react-dom/client'\nimport {\n  SketchProvider,\n  SketchAttachment,\n  useSketchApp,\n  useSketchTick,\n} from 'sketch-react-app'\n\nconst container = document.querySelector('.js-app') as HTMLElement\nconst root = createRoot(container)\nroot.render(<App />)\n\nfunction App() {\n  return (\n    <SketchProvider>\n      <Container>\n        <Sketch />\n        <Controls />\n      </Container>\n    </SketchProvider>\n  )\n}\n\nfunction Container({children}: {children: React.ReactNode}) {\n  return <div style={{width: '100vw', height: '100vh'}}>{children}</div>\n}\n\nfunction Sketch() {\n  useSketchTick(render)\n  return <SketchAttachment />\n}\n\nfunction Controls() {\n  const app = useSketchApp()\n  const [isRunning, setIsRunning] = useState(true)\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: 16,\n        right: 16,\n        padding: 8,\n        backgroundColor: 'rgba(0, 0, 0, 0.12)',\n        borderRadius: 3,\n      }}>\n      <button\n        disabled={app == null}\n        onClick={() => {\n          if (app == null) {\n            return\n          }\n\n          if (isRunning) {\n            setIsRunning(false)\n            app.stop()\n          } else {\n            setIsRunning(true)\n            app.start()\n          }\n        }}>\n        {isRunning ? 'Pause' : 'Resume'}\n      </button>\n    </div>\n  )\n}\n\nlet time = 0\nfunction render({app, dt}: {app: Application; dt: number}) {\n  time = time + dt / 500\n\n  const padding = 16\n  const gradient = app.ctx.createLinearGradient(\n    0,\n    app.ctx.canvas.height * 0.85,\n    app.ctx.canvas.width,\n    app.ctx.canvas.height * 0.25\n  )\n  gradient.addColorStop(0, '#85ffbd')\n  gradient.addColorStop(1, '#fffb7d')\n  app.ctx.fillStyle = gradient\n  app.ctx.fillRect(\n    0 + padding,\n    0 + padding,\n    app.ctx.canvas.width - padding * 2,\n    app.ctx.canvas.height - padding * 2\n  )\n\n  app.ctx.beginPath()\n  app.ctx.strokeStyle = '#484442'\n  app.ctx.lineWidth = 4\n  app.ctx.arc(\n    app.canvas.width * 0.5,\n    app.canvas.height * 0.5,\n    Math.min(app.canvas.width, app.canvas.height) *\n      0.25 *\n      (1 + Math.sin(time) * 0.2),\n    0,\n    Math.PI * 2\n  )\n  app.ctx.stroke()\n}\n","// src/index.ts\nimport { attach } from \"sketch-attach\";\nimport { withTick, withResize, BaseApplication } from \"sketch-application\";\nfunction loop(opts) {\n  const { canvas } = attach(opts);\n  const app = new Application(canvas);\n  return app;\n}\nvar Application = withTick(withResize(BaseApplication));\nexport {\n  Application,\n  loop\n};\n","// src/index.tsx\nimport { createContext, useContext, useEffect, useRef, useState } from \"react\";\nimport { loop } from \"sketch-loop\";\nimport { jsx } from \"react/jsx-runtime\";\nvar applicationContext = createContext(null);\nfunction SketchProvider({ children }) {\n  const [app, setApp] = useState(null);\n  return /* @__PURE__ */ jsx(applicationContext.Provider, {\n    value: {\n      app,\n      setApp\n    },\n    children\n  });\n}\nfunction SketchAttachment() {\n  const ctx = useContext(applicationContext);\n  const canvas = useRef(null);\n  useEffect(() => {\n    if (ctx == null) {\n      throw new Error(\"Sketch attachment must be a child of a sketch provider\");\n    }\n    if (canvas == null || canvas.current == null) {\n      return;\n    }\n    if (ctx.app == null) {\n      const app = loop({ canvas: canvas.current });\n      app.start();\n      ctx.setApp(app);\n    } else {\n      ctx.app.start();\n    }\n    return () => {\n      if (ctx && ctx.app != null) {\n        ctx.app.dispose();\n      }\n    };\n  }, [canvas, ctx]);\n  return /* @__PURE__ */ jsx(\"canvas\", {\n    ref: canvas\n  });\n}\nfunction useSketchApp() {\n  const ctx = useContext(applicationContext);\n  return (ctx == null ? void 0 : ctx.app) ?? null;\n}\nfunction useSketchTick(onTick) {\n  const app = useSketchApp();\n  useEffect(() => {\n    if (app == null) {\n      return;\n    }\n    const unsubscribe = app.on({\n      type: \"tick\",\n      action: onTick\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, [onTick, app]);\n}\nexport {\n  SketchAttachment,\n  SketchProvider,\n  useSketchApp,\n  useSketchTick\n};\n"],"names":["$fRwNr","parcelRequire","$io0Tf","$lx97N","$3609002d17f8ee44$export$f9ef67375ddc185","opts","canvas","attach","$3609002d17f8ee44$export$16975c34e60e1e61","$7XNOC","withTick","withResize","BaseApplication","$047711456d6e6005$var$applicationContext","createContext","$047711456d6e6005$export$d4bf0edbbddc8898","children","app","setApp","useState","jsx","Provider","value","$047711456d6e6005$export$eef3e2c8cb25a94","ctx","useContext","useRef","useEffect","Error","current","start","dispose","ref","$047711456d6e6005$export$ea7bba1837e9aed6","$047711456d6e6005$export$13cd8a13eebf141f","onTick","unsubscribe","on","type","action","$d37577e24297bce2$var$container","document","querySelector","$d37577e24297bce2$var$App","jsxs","$d37577e24297bce2$var$Container","$d37577e24297bce2$var$Sketch","$d37577e24297bce2$var$Controls","style","width","height","$d37577e24297bce2$var$render","isRunning","setIsRunning","position","top","right","padding","backgroundColor","borderRadius","disabled","onClick","stop","$jhfT6","createRoot","render","$d37577e24297bce2$var$time","dt","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","beginPath","strokeStyle","lineWidth","arc","Math","min","sin","PI","stroke"],"version":3,"file":"index.e65e398a.js.map"}